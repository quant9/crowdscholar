{% extends "base.html" %}
{% block title %}Crowdscholar: browsing scholarship
{% endblock %}
{% block content %}
  {% from "macros.html" import show_messages %}
  <h1>Browse Scholarships</h1>
  {{ show_messages() }}
  {% if scholarship %}
    <p>Viewing scholarship: {{ scholarship.name }}</p>
    <ul>
      <li>Scholarship ID: {{ scholarship.scholarship_id }}</li>
      <li>Created by: {{ scholarship.get_creator().first_name }}</li>
      <li>Expires on: {{ scholarship.expiration_date }}</li>
      <li>${{ scholarship.amount_funded | round|int }} funded out of ${{ scholarship.amount_target | round|int }}</li>
      <li>{{ scholarship.slug }}</li>
      {% set num_donors = scholarship.get_num_donors() %}
      <li>Number of donors: {{ num_donors }}</li>
      {% if num_donors > 0 %}
        <li>Donors:</li>
        <ul>
        {% for donor in scholarship.get_donors() %}
          <li>{{ donor.first_name | capitalize }} {{ donor.last_name[:1] | upper }}.: ${{ donor.amount | round|int }}</li>
        {% endfor %}
        </ul>
      {% else %}
        <li>Be the first to donate!</li>
      {% endif %}
    </ul>
    <ul>
      <li><a href="{{ url_for('donor.donate', scholarship_id=scholarship.scholarship_id) }}">Donate to this scholarship</a></li>
      <li>Save this scholarship</li>
    </ul>
    <a href="{{ url_for('donor.browse') }}">Back to scholarships</a>
  {% else %}<p>Viewing all scholarships</p>
    {% for scholarship in s_list.items %}
      <ul>
        <li>Scholarship: {{ scholarship.name }}</li>
        <li>Scholarship ID: {{ scholarship.scholarship_id }}</li>
        <li>Created by: {{ scholarship.get_creator().first_name }}</li>
        <li>Expires on: {{ scholarship.expiration_date }}</li>
        <li>${{ scholarship.amount_funded | round|int }} funded out of ${{ scholarship.amount_target | round|int }}</li>
        <li>{{ scholarship.slug }}</li>
        <li>Number of donors: {{ scholarship.get_num_donors() }}</li>
        <li><a href="{{ url_for('donor.browse', scholarship_id=scholarship.scholarship_id) }}">
          Go to scholarship page</a></li>
        <li><a href="{{ url_for('donor.donate', scholarship_id=scholarship.scholarship_id) }}">
          Donate to this scholarship</a></li>
      </ul>
    {% endfor %}
    <p>Viewing scholarships {{ s_list.page }} - {{ minimum([s_list.page+rpp-1, s_list.total]) }} out of {{ s_list.total }}</p>
    <p>{% if s_list.has_prev %}
      <a href="{{ url_for('donor.browse', page_num=s_list.prev_num) }}">Previous page</a>
    {% else %}Previous page{% endif %} | 
    {% if s_list.has_next %}
      <a href="{{ url_for('donor.browse', page_num=s_list.next_num) }}">Next page</a>
    {% else %}Next page{% endif %}</p>
  {% endif %}

{% endblock %}